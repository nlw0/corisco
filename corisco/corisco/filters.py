## This module defines a number of different directional derivative
## filters, on the horizontal direction, for use in edge-detection
## techniques. There are also some Laplacean filters for the Zernike
## moments edge detection method.

from numpy import array

## Directional derivative filters

## Classics never die, even if sometimes we think they might.
sobel_filter=array(
    [[-1, 0, 1],
     [-2, 0, 2],
     [-1, 0, 1]
     ]) / 8.0

scharr_filter=array(
    [[ -3, 0, 3],
     [-10, 0,10],
     [ -3, 0, 3]
     ]) / 32.0

## Developed by Shigeru Ando, from the article "Consistent Gradient
## Operators", IEEE TPAMI v.22 n.3 (2000)
shigeru_filter=-array(
    [[ -0.003776, -0.010199, 0., 0.010199, 0.003776 ],
     [ -0.026786, -0.070844, 0., 0.070844, 0.026786 ],
     [ -0.046548, -0.122572, 0., 0.122572, 0.046548 ],
     [ -0.026786, -0.070844, 0., 0.070844, 0.026786 ],
     [ -0.003776, -0.010199, 0., 0.010199, 0.003776 ]
     ])

## Zernike moments stuff. You can think of the V11 moments as gradient
## filters, and the V20 as Laplacean.
zernike_V11_5x5 = array(
    [[ -146.67,  -468.68,     0.  ,   468.68,   146.67],
     [ -933.33,  -640.  ,     0.  ,   640.  ,   933.33],
     [-1253.33,  -640.  ,     0.  ,   640.  ,  1253.33],
     [ -933.33,  -640.  ,     0.  ,   640.  ,   933.33],
     [ -146.67,  -468.68,     0.  ,   468.68,   146.67]
     ]) / 19368.05


zernike_V11_7x7 = array(
    [[   0.  , -150.46, -190.2 ,    0.  ,  190.2 ,  150.46,    0.  ],
     [-224.25, -465.74, -233.24,    0.  ,  233.24,  465.74,  224.25],
     [-573.37, -466.47, -233.24,    0.  ,  233.24,  466.47,  573.37],
     [-689.99, -466.47, -233.24,    0.  ,  233.24,  466.47,  689.99],
     [-573.37, -466.47, -233.24,    0.  ,  233.24,  466.47,  573.37],
     [-224.25, -465.74, -233.24,    0.  ,  233.24,  465.74,  224.25],
     [   0.  , -150.46, -190.2 ,    0.  ,  190.2 ,  150.46,    0.  ]
     ]) / 27314.0


zernike_V11_9x9 = array(
    [[ 0., -11.73, -109.17, -94.2, 0., 94.2, 109.17, 11.73, 0. ],
     [ -16.09, -253.68, -219.48, -109.74, 0., 109.74, 219.48, 253.68, 16.09],
     [-214.91, -329.22, -219.48, -109.74, 0., 109.74, 219.48, 329.22, 214.91],
     [-379.52, -329.22, -219.48, -109.74, 0., 109.74, 219.48, 329.22, 379.52],
     [-434.39, -329.22, -219.48, -109.74, 0., 109.74, 219.48, 329.22, 434.39],
     [-379.52, -329.22, -219.48, -109.74, 0., 109.74, 219.48, 329.22, 379.52],
     [-214.91, -329.22, -219.48, -109.74, 0., 109.74, 219.48, 329.22, 214.91],
     [ -16.09, -253.68, -219.48, -109.74, 0., 109.74, 219.48, 253.68, 16.09],
     [ 0., -11.73, -109.17, -94.2, 0., 94.2, 109.17, 11.73, 0. ]
     ]) / 35236.70736

zernike_V20_5x5 = array(
    [[  176.  ,   595.07,   505.86,   595.07,   176.  ],
     [  595.07,  -490.67, -1002.67,  -490.67,   595.07],
     [  505.86, -1002.67, -1514.67, -1002.67,   505.86],
     [  595.07,  -490.67, -1002.67,  -490.67,   595.07],
     [  176.  ,   595.07,   505.86,   595.07,   176.  ]
     ]) * 2.5 / 19368.05


zernike_V20_7x7 = array(
    [[   0.  ,  224.66,  393.73,  395.52,  393.73,  224.66,    0.  ],
     [ 224.66,  271.06, -127.72, -261.  , -127.72,  271.06,  224.66],
     [ 393.73, -127.72, -527.56, -660.84, -527.56, -127.72,  393.73],
     [ 395.52, -261.  , -660.84, -794.11, -660.84, -261.  ,  395.52],
     [ 393.73, -127.72, -527.56, -660.84, -527.56, -127.72,  393.73],
     [ 224.66,  271.06, -127.72, -261.  , -127.72,  271.06,  224.66],
     [   0.  ,  224.66,  393.73,  395.52,  393.73,  224.66,    0.  ]
     ]) * 3.5 / 27314.0

zernike_V20_9x9 = array(
    [[ 0. , 19.03, 200.93, 278.78, 290.06, 278.78, 200.93, 19.03, 0. ],
     [ 19.03, 274.72, 148.35, 2.03, -46.74, 2.03, 148.35, 274.72, 19.03],
     [ 200.93, 148.35, -95.51, -241.83, -290.61, -241.83, -95.51, 148.35, 200.93],
     [ 278.78, 2.03, -241.83, -388.15, -436.93, -388.15, -241.83, 2.03, 278.78],
     [ 290.06, -46.74, -290.61, -436.93, -485.7 , -436.93, -290.61, -46.74, 290.06],
     [ 278.78, 2.03, -241.83, -388.15, -436.93, -388.15, -241.83, 2.03, 278.78],
     [ 200.93, 148.35, -95.51, -241.83, -290.61, -241.83, -95.51, 148.35, 200.93],
     [ 19.03, 274.72, 148.35, 2.03, -46.74, 2.03, 148.35, 274.72, 19.03],
     [ 0. , 19.03, 200.93, 278.78, 290.06, 278.78, 200.93, 19.03, 0. ]
     ]) * 4.5 / 35236.70736

DERIVATIVE_FILTERS = {'sobel': (sobel_filter, None),
                      'scharr': (scharr_filter, None), 
                      'shigeru': (shigeru_filter, None),
                      'zernike5': (zernike_V11_5x5, zernike_V20_5x5),
                      'zernike7': (zernike_V11_7x7, zernike_V20_7x7),
                      'zernike9': (zernike_V11_9x9, zernike_V20_9x9)}
